# ๐งฉ Python Code Style & Convention โ ุฎูุงุตู ู ฺฉุงุฑุจุฑุฏ

> ุจุฑ ูพุงูโ PEP8 ู ุฑุงูููุง ุฏุงุฎู ูพุฑูฺูโ AUT  
> ูุฏู: ฺฉุฏ ุจููุณู ฺฉู ุชูุฒุ ุฎูุงูุงุ ุชุณุชโูพุฐุฑ ู ูุงุจู ูฺฏูโุฏุงุฑ ุจุงุดุฏ.

---

## 1๏ธโฃ ูุงูุจโุจูุฏ ู ูฺฏุงุฑุด (Code Style)

| ููุฑุฏ | ูุงุนุฏู |
|------|--------|
| **ุทูู ุฎุท** | ุญุฏุงฺฉุซุฑ 88 ุชุง 100 ฺฉุงุฑุงฺฉุชุฑ |
| **ุชูุฑูุชฺฏ (Indent)** | 4 ูุงุตููโ ุฎุงู (Tab ููููุน) |
| **ูุงุตููโูุง (Whitespace)** | ุจุนุฏ ุงุฒ `,` ู ุงุทุฑุงู `=` ุง `+` ูุงุตูู ุจฺฏุฐุงุฑ |
| **ุฎุทูุท ุฎุงู** | ุจู ุชูุงุจุน ุณุทุญ ูุงฺูู โ 2 ุฎุทุ ุจู ูุชุฏูุง ฺฉูุงุณ โ 1 ุฎุท |
| **ุฑุดุชูโูุง (Strings)** | ุงุฒ `'` ุง `"` ุจูโุตูุฑุช ุซุงุจุช ุงุณุชูุงุฏู ฺฉูุ f-string ุจุฑุง ูุงูุจโฺฏุฐุงุฑ |
| **ุงููพูุฑุชโูุง** | ุชุฑุชุจ: <br>1๏ธโฃ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ <br>2๏ธโฃ ฺฉุชุงุจุฎุงูู ุฎุงุฑุฌ <br>3๏ธโฃ ูุงฺููโูุง ุฏุงุฎู ูพุฑูฺู |
| **ุซุงุจุชโูุง (Constants)** | `UPPER_SNAKE_CASE` |

๐ *ููููู:*
```python
from dataclasses import dataclass
import httpx

from myapp.repositories import UserRepo
```

---

## 2๏ธโฃ ูุงูโฺฏุฐุงุฑ (Naming Conventions)

| ููุน | ุณุจฺฉ | ูุซุงู |
|------|------|-------|
| ูุงฺูู/ูุงู | `snake_case` | `user_service.py` |
| ุชุงุจุน/ูุชุบุฑ | `snake_case` | `load_config()` |
| ฺฉูุงุณ | `PascalCase` | `UserRepository` |
| ุซุงุจุชโูุง | `UPPER_SNAKE_CASE` | `MAX_RETRY = 3` |
| ุฎุตูุต | ุจุง `_` ุดุฑูุน ุดูุฏ | `_normalize_email()` |
| ุจููโูุง | ุจุง `is_`, `has_`, `can_` | `is_active`, `has_access` |

---

## 3๏ธโฃ ฺฉุงููุช ู ูุณุชูุฏุณุงุฒ (Comments & Docstrings)

- ูุฏู: ุชูุถุญ **ฺุฑุง (why)**ุ ูู ููุท **ฺุณุช (what)**  
- ุงุฒ ุงูฺฏูุณ ุณุงุฏู ู ูุดุฑุฏู ุงุณุชูุงุฏู ฺฉู.  
- ุฏุงฺฉโุงุณุชุฑูฺฏ ุจุฑุง ูุฑ ูุงฺููุ ฺฉูุงุณ ู ุชุงุจุน ููู ุงูุฒุงู ุงุณุช.  

๐ *ููููู Docstring:*
```python
def get_discount(amount: int) -> int:
    """Return discount percentage based on amount.

    :param amount: total purchase in Rials
    :return: discount (0โ30)
    :raises ValueError: if amount is negative
    """
```

---

## 4๏ธโฃ ุทุฑุงุญ ุชูุงุจุน ู ฺฉูุงุณโูุง

- ูุฑ ุชุงุจุน ุจุงุฏ **ฺฉ ูุณุฆููุช** ุฏุงุดุชู ุจุงุดุฏ (Single Responsibility).  
- ุทูู ุชุงุจุน: โค 25โ30 ุฎุท.  
- ูพุงุฑุงูุชุฑูุง: โค 5 ุนุฏุฏ.  
- ูพุงุฑุงูุชุฑูุง ุงุฎุชุงุฑ ุฑุง **ฺฉูุฏูุงฺูโุง (keyword-only)** ุจููุณ.  
- ุงฺฏุฑ ฺูุฏ ูพุงุฑุงูุชุฑ ูุฑุชุจุท ุฏุงุฑุ ุงุฒ `@dataclass` ุงุณุชูุงุฏู ฺฉู.

๐ *ููููู:*
```python
from dataclasses import dataclass
from typing import Literal

@dataclass
class ChargeRequest:
    user_id: int
    amount: int
    currency: Literal["IRR", "USD"] = "IRR"

class BillingService:
    def charge(self, *, req: ChargeRequest) -> str:
        """Perform payment and return transaction ID."""
```

---

## 5๏ธโฃ ุชุงูพโููุชูฺฏ (Type Hinting)

> ุงุตู ุทูุง: ยซูุฑ ุชุงุจุน ฺฉู ุงูุถุง ุฏุงุฑุฏุ ุจุงุฏ ุชุงูพ ูู ุฏุงุดุชู ุจุงุดุฏ.ยป

- ูุฑูุฏ ู ุฎุฑูุฌโูุง ุฑุง ุชุงูพ ฺฉู.  
- ุงุฒ ุชุงูพโูุง ุฏูู ุงุณุชูุงุฏู ฺฉู (`list[int]`, `dict[str, Any]`, โฆ).  
- ุงุฒ `Any` ููุท ุฏุฑ ููุงุฑุฏ ุถุฑูุฑ ุงุณุชูุงุฏู ฺฉู.  
- ุจุฑุง ฺูุฏ ููุน ุฏุงุฏู ุงุฒ `|` (Union) ุง `Optional` ุงุณุชูุงุฏู ฺฉู.  
- ุงุฒ `Protocol` ู `TypeVar` ุจุฑุง ูุงุจุณุชฺฏโูุง ฺฉูโุชุฑ ุงุณุชูุงุฏู ฺฉู.

๐ *ูููููโูุง:*
```python
def parse(data: int | str) -> str: ...
def find_user(id: int) -> str | None: ...
```

---

## 6๏ธโฃ ุงุณุชุซูุงูุง (Exceptions)

- ูููโ ุงุณุชุซูุงูุง ุจุงุฏ ูพุณููุฏ **Error** ุง **Exception** ุฏุงุดุชู ุจุงุดูุฏ.  
- ุจุฑุง ุฏุงูููโูุง ุฎุงุต Base Exception ุฌุฏุง ุจุณุงุฒ.  
- ูพุงู ุฎุทุง ุจุงุฏ ฺฉูุชุงู ู ูุงุจู ููู ุจุงุดุฏ.  

๐ *ููููู:*
```python
class TaskError(Exception):
    """Base exception for task operations."""

class InvalidStatusError(TaskError):
    """Raised when an invalid task status is provided."""
```

---

## 7๏ธโฃ ฺฉุฏ ุชูุฒ ู ุถุฏ ุงูฺฏููุง (Code Smells)

| ุจู ุจุฏ | ุชูุถุญ | ุฑุงูโุญู |
|--------|--------|--------|
| ุชุงุจุนโูุง ุฎู ุจููุฏ | ุจุด ุงุฒ ฺฉ ูุณุฆููุช | ุชูุณู ุจู ฺูุฏ ุชุงุจุน ฺฉูฺฉ |
| ุชฺฉุฑุงุฑ ฺฉุฏ | ฺฉูพ/ูพุณุช ููุทู ูุดุงุจู | ุชุงุจุน ุง ูุงฺูู ูุดุชุฑฺฉ ุจุณุงุฒ |
| ุดุฑุทโูุง ุชู ุฏุฑ ุชู | if ุฒุงุฏ | ุงุณุชูุงุฏู ุงุฒ Guard Clause |
| ูุงูโูุง ูุจูู | `x`, `foo`, `data1` | ูุงูโูุง ูุงุถุญ ู ูุนูุงุฏุงุฑ |
| ุงุณุชูุงุฏู ุฒุงุฏ ุงุฒ `Any` | ุงุฒ ุจู ุฑูุชู ุฏูุช ุชุงูพ | ุชุงูพ ุฏููโุชุฑ ุงูุชุฎุงุจ ฺฉู |

๐ *ููููู ุฑูฺฉุชูุฑ:*
```python
# โ ุจุฏ
if user and user.is_active and has_permission(user, "pay"):
    process_payment(user)

# โ ุฎูุจ
if not user or not user.is_active or not has_permission(user, "pay"):
    return
process_payment(user)
```

---

## 8๏ธโฃ ุชุฒุฑู ูุงุจุณุชฺฏ (Dependency Injection)

- ููุดู ูุงุจุณุชฺฏโูุง ุฑุง ุงุฒ **ุจุฑูู ูุงุฑุฏ ฺฉู (Constructor Injection)**.  
- ุจูโุฌุง ุณุงุฎุชู ูุงุจุณุชฺฏ ุฏุฑ ุฏุงุฎู ฺฉูุงุณุ ุขู ุฑุง ุจูโุนููุงู ูพุงุฑุงูุชุฑ ุจฺฏุฑ.  
- ูุฏู: ฺฉุฏ ูุงุจู ุชุณุช ู ูุงุจู ุชูุณุนู.

๐ *ููููู:*
```python
class TaskService:
    def __init__(self, storage: "StorageProtocol"):
        self._storage = storage
```

---

## โ ฺฺฉโูุณุช ููุง

- [ ] ุทูู ุฎุท โค 88 ฺฉุงุฑุงฺฉุชุฑ  
- [ ] ุชูุฑูุชฺฏ 4 ูุงุตูู  
- [ ] ุงููพูุฑุชโูุง ูุฑุชุจ  
- [ ] ูุงูโฺฏุฐุงุฑ ูุทุงุจู ููุงุนุฏ  
- [ ] ุชุงูพโููุช ฺฉุงูู  
- [ ] ุชูุงุจุน ฺฉูุชุงู ู ุชฺฉโูุธููโุง  
- [ ] ุฏุงฺฉโุงุณุชุฑูฺฏ ู ฺฉุงููุช ููุฏ  
- [ ] ุจุฏูู ุชฺฉุฑุงุฑ ุง nested ุฒุงุฏ  
- [ ] ุงุณุชุซูุงูุง ุจุง ูุงู ุดูุงู  
